version: '3.8'
services:
    backend:
        image: sa-backend
        build:
            context: .
            dockerfile: Dockerfile
        ports:
            - "5000:5000"
        env_file:
            -   .env
        networks:
            - sa_cs2

    rabbitmq:
        image: rabbitmq:4.1-rc
        networks:
            - sa_cs2
        command: bash -c "rabbitmq-plugins enable rabbitmq_management && rabbitmq-server"
        ports:
            - 5672:5672
            - 15672:15672
        environment:
            RABBITMQ_PLUGINS: "rabbitmq_management"

    redis:
        image: redis:7.4.2
        networks:
            - sa_cs2
        ports:
            - 6379:6379
        volumes:
            - sa_cs2-redis:/data

volumes:
    sa_cs2-redis:
        driver: local

networks:
    sa_cs2:
