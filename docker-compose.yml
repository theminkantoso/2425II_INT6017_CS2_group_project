version: '3.8'
services:
    ocr_service:
        image: sa-backend-ocr
        build:
            context: ./ocr_service
            dockerfile: Dockerfile
        ports:
            - "5000:5000"
        env_file:
            -   ./ocr_service/.env
        networks:
            - sa_cs2

    pdf_service:
        image: sa-backend-pdf
        build:
            context: ./pdf_service
            dockerfile: Dockerfile
        ports:
            - "5001:5001"
        env_file:
            - ./pdf_service/.env
        networks:
            - sa_cs2

    translation_service:
        image: sa-backend-translate
        build:
            context: ./translation_service
            dockerfile: Dockerfile
        ports:
            - "5002:5002"
        env_file:
            - ./translation_service/.env
        networks:
            - sa_cs2

    rabbitmq:
        image: rabbitmq:4.1-rc
        networks:
            - sa_cs2
        command: bash -c "rabbitmq-plugins enable rabbitmq_management && rabbitmq-server"
        ports:
            - 5672:5672
            - 15672:15672
        environment:
            RABBITMQ_PLUGINS: "rabbitmq_management"

    redis:
        image: redis:7.4.2
        networks:
            - sa_cs2
        ports:
            - 6379:6379
        volumes:
            - sa_cs2-redis:/data

volumes:
    sa_cs2-redis:
        driver: local

networks:
    sa_cs2:
